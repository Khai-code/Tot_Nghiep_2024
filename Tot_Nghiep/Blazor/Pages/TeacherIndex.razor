@page "/teacherindex"
@using global::Data.Model
@layout Teacherlayout
@inject HttpClient client
@inject IJSRuntime jsRuntime

<h3>Biểu đồ tròn</h3>
<div class="row">
    <div style="height:200px;width:200px"> 
        <canvas id="myPieChart"></canvas>
    </div>
</div>


@code {
    private List<PieChartData> pieChartData = new List<PieChartData>();
    private bool isDataLoaded = false; 

    protected override async Task OnInitializedAsync()
    {
        // Thay đổi URL cho phù hợp với API của bạn
        pieChartData = await client.GetFromJsonAsync<List<PieChartData>>("api/Role/get-piechart-data");
        isDataLoaded = true; // Đánh dấu dữ liệu đã được tải
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && isDataLoaded)
        {
            // Sau khi nhận dữ liệu từ API, gọi hàm JavaScript để vẽ biểu đồ
            await jsRuntime.InvokeVoidAsync("drawPieChart",
                pieChartData.Select(d => d.Label).ToArray(),
                pieChartData.Select(d => d.Value).ToArray());
        }
    }

    public class PieChartData
    {
        public string Label { get; set; }
        public int Value { get; set; }
    }
}
<script>
    window.drawPieChart = (labels, data) => {
        var ctx = document.getElementById('myPieChart').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: {
              
                datasets: [{
                    data: data,
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'],
                    hoverBackgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
                }],
                labels: labels,
            },
            options: {
                responsive: true,
                title: {
                    display: true,
                    text: 'Thống kê biểu đồ tròn'
                }
            }
        });
    };


</script>

 <h3>TeacherIndex</h3>
 <div>

 </div>
 <div class="row">
     <div class="col-md-7 border ">
        
     </div>
     <div class="col-md-1"></div>
     <div class="col-md-4 border">
         <h2>Bảng thông báo</h2>
         <table>
             <thead>
                 <tr>
                     <th>Thông báo</th>
                 </tr>
             </thead>
             <tbody>
                 @* @foreach (var notification in notifications)
                 {
                     <tr>
                          <td>@notification.Title</td>
                     </tr>
                 } *@
             </tbody>
         </table>
     </div>
 </div>

@*  @code {
     private List<Notification>? notifications = new List<Notification>();

     protected override async Task OnInitializedAsync()
     {
         notifications = await client.GetFromJsonAsync<List<Notification>>("api/Notification/get-all-notification");
     }
 } *@

 <style>
     /* Giới hạn chiều cao của bảng và cho phép cuộn */
     .table-fixed {
         height: 250px; /* Chiều cao cố định */
         overflow-y: scroll;
     }

     .table-fixed thead {
         position: sticky;
         top: 0;
         background-color: #343a40; /* Màu nền tối cho tiêu đề */
         z-index: 100;
     }
 </style>
<div class="card-body card-body-style-1" id="card-body-type-36">

    <div class="d-flex justify-content-between m-r-10 m-l-10">
        <div class="d-flex flex-column text-align-center justify-content-between">



            <span class="svg-icon svg-icon-primary svg-icon-3x">
                <svg width="45" height="32" viewBox="0 0 45 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1371_2816)">
                        <path d="M14.9395 22C14.7775 22 14.6156 22.0219 14.4611 22.0681C13.5831 22.3312 12.6597 22.5 11.6875 22.5C10.7153 22.5 9.79192 22.3312 8.91322 22.0681C8.75876 22.0219 8.59752 22 8.4356 22C4.23113 22 0.825409 25.155 0.847766 29.0387C0.85725 30.68 2.31994 32 4.09969 32H19.2754C21.0551 32 22.5178 30.68 22.5273 29.0387C22.5496 25.155 19.1439 22 14.9395 22ZM11.6875 20C15.2796 20 18.1914 17.3138 18.1914 14C18.1914 10.6862 15.2796 8 11.6875 8C8.0955 8 5.18367 10.6862 5.18367 14C5.18367 17.3138 8.0955 20 11.6875 20ZM40.9549 0H14.9395C13.1462 0 11.6875 1.39062 11.6875 3.09938V6C13.2742 6 14.743 6.42375 16.0234 7.1125V4H39.8709V22H35.535V18H26.8632V22H21.698C22.992 23.0431 23.9419 24.4206 24.387 26H40.9549C42.7482 26 44.2068 24.6094 44.2068 22.9006V3.09938C44.2068 1.39062 42.7482 0 40.9549 0Z" fill="#097687"></path>
                    </g>
                    <defs>
                        <clipPath id="clip0_1371_2816">
                            <rect width="43.359" height="32" fill="white" transform="translate(0.847656)"></rect>
                        </clipPath>
                    </defs>
                </svg>
            </span>

            <span class="text-color-2 text-style-2">25</span>
            <span class="text-style-1 text-color-1">Nhân sự</span>
        </div>
        <div class="d-flex flex-column justify-content-between note-style-1" style=" margin-top: 10px; margin-bottom: 10px;">
            <div class="d-flex align-items-center">
                <div class="bg-radial icon-style-1" style="background-color: #05545C"></div>
                <span>Giáo viên (22)</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="bg-radial icon-style-1" style="background-color: #097687"></div>
                <span>Nhân viên (1)</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="bg-radial icon-style-1" style="background-color: #0D8A9F"></div>
                <span>Quản lý (2)</span>
            </div>
        </div>
        <div class="d-flex align-items-center justify-content-center " id="chart-style-1-data-36" data-labels="[&quot;Giáo viên&quot;,&quot;Nhân viên&quot;,&quot;Quản lý&quot;]" data-values="[22,1,2]" data-colors="[&quot;#05545C&quot;,&quot;#097687&quot;,&quot;#0D8A9F&quot;]">
            <canvas id="chart-style-1-36" width="125" height="125" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
        </div>
    </div>


</div>





















































































































